!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports):"function"==typeof define&&define.amd?define(["exports"],o):o((e=e||self).VueRescroll={})}(this,function(e){"use strict";var o=function(){this.position={x:0,y:0}};o.prototype.$savePosition=function(e){return Object.assign(this.position,e)};var t=function(e){this.vnode={},this.opt=e,this.timer={},this.openScrollStore(),this.getPosition(),this.scrollTo()};t.prototype.update=function(){return this.scrollTo(),this},t.prototype.openScrollStore=function(){var e=this.opt,t=e.rescroll;void 0===t&&(t=null);var r=e.name,i=e.storageMode;return void 0===i&&(i=""),t&&"localstorage"!==i?(t[r]||(t[r]=new o),this):this},t.prototype.getPosition=function(){var e,o=this,t=this.opt,i=t.dom,l=t.name,n=t.rescroll,s=t.type,c=t.storageMode,a=t.key;return e=s&&"window"===s?window:i,this.watchScroll=function(){if(l===r){var e="timer-"+l;clearTimeout(o.timer[e]),o.timer[e]=setTimeout(function(){var e;e=s&&"window"===s?{x:window.scrollX,y:window.scrollY}:{x:i.scrollLeft,y:i.scrollTop},c&&"localstorage"===c?localStorage.setItem(""+a,JSON.stringify(e)):n[l].$savePosition(e),delete o.timer[a]},1e3/60)}},e.addEventListener("scroll",this.watchScroll,!1),this},t.prototype.scrollTo=function(){var e,o=this,t=this.opt,r=t.dom,i=t.name,l=t.rescroll,n=t.type,s=t.storageMode,c=t.key,a=t.vnode;if(s&&"localstorage"===s){var d=localStorage.getItem(""+c);if(!d)return this;e=JSON.parse(d)}else e=l[i].position;if(!e)return this;var u=e.x;void 0===u&&(u=0);var p=e.y;return void 0===p&&(p=0),a.context?(a.context.$nextTick(function(){if(n&&"window"===n)window.scrollTo(u,p);else{if(!l[i]||r.scrollHeight<p||r.scrollWidth<u)return r.scrollLeft=0,r.scrollTop=0,o;r.scrollLeft=u,r.scrollTop=p}}),this):this},t.prototype.destroy=function(){var e=this.opt.dom;return this.watchScroll&&e.removeEventListener("scroll",this.watchScroll,!1),this};var r="",i=function(e,o,i){if(!o.value)throw Error("please set required parameters");if(r=o.value.name,!i.context)throw Error("it is not a vnode");if(i.context.$root){var l,n=i.context.$root,s=o.value,c=s.name,a=s.type;void 0===a&&(a="");var d=s.storageMode;void 0===d&&(d="");var u=s.key;void 0===u&&(u="");var p=s.domType;if(void 0===p&&(p=""),!c)throw Error("please set name");return"localstorage"===o.value.storageMode?l={dom:e,name:c,type:a,storageMode:d,key:u,vnode:i}:(n.$rescroll||(n.$rescroll={}),l={dom:e,name:c,type:a,storageMode:d,key:u,vnode:i,rescroll:n.$rescroll}),e.restoreScroll||(e.restoreScroll={}),e.restoreScroll[r]?void(p&&"tab"===p&&e.restoreScroll[r].update(l)):void(e.restoreScroll[r]=new t(l))}},l={inserted:function(e,o,t){return i(e,o,t)},componentUpdated:function(e,o,t){return i(e,o,t)},unbind:function(e){e.restoreScroll&&e.restoreScroll[r]&&(e.restoreScroll[r].destroy(),delete e.restoreScroll)}},n={install:function(e){e.directive("rescroll",l)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),e.default=n,e.directive=l,Object.defineProperty(e,"__esModule",{value:!0})});
