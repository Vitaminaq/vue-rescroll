!function(o,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((o=o||self).VueRescroll={})}(this,function(o){"use strict";var e=function(){this.position={x:0,y:0}};e.prototype.$savePosition=function(o){return Object.assign(this.position,o)};var t=function(o){this.vnode={},this.opt=o,this.timer={},this.openScrollStore(),this.getPosition(),this.scrollTo()};t.prototype.update=function(){return this.scrollTo(),this},t.prototype.openScrollStore=function(){var o=this.opt,t=o.rescroll;void 0===t&&(t=null);var r=o.name,i=o.storageMode;return void 0===i&&(i=""),t&&"localstorage"!==i?(t[r]||(t[r]=new e),this):this},t.prototype.getPosition=function(){var o,e=this,t=this.opt,i=t.dom,l=t.name,n=t.rescroll,s=t.type,c=t.storageMode;return o=s&&"window"===s?window:i,this.watchScroll=function(){if(l===r){var o="timer-"+l;clearTimeout(e.timer[o]),e.timer[o]=setTimeout(function(){var t;t=s&&"window"===s?{x:window.scrollX,y:window.scrollY}:{x:i.scrollLeft,y:i.scrollTop},c&&"localstorage"===c?localStorage.setItem(""+l,JSON.stringify(t)):n[l].$savePosition(t),delete e.timer[o]},1e3/60)}},o.addEventListener("scroll",this.watchScroll,!1),this},t.prototype.scrollTo=function(){var o,e=this,t=this.opt,r=t.dom,i=t.name,l=t.rescroll,n=t.type,s=t.storageMode,c=t.vnode;if(s&&"localstorage"===s){var a=localStorage.getItem(""+i);if(!a)return this;o=JSON.parse(a)}else o=l[i].position;if(!o)return this;var d=o.x;void 0===d&&(d=0);var u=o.y;return void 0===u&&(u=0),c.context?(c.context.$nextTick(function(){if(n&&"window"===n)window.scrollTo(d,u);else{if(!l[i]||r.scrollHeight<u||r.scrollWidth<d)return r.scrollLeft=0,r.scrollTop=0,e;r.scrollLeft=d,r.scrollTop=u}}),this):this},t.prototype.destroy=function(){var o=this.opt.dom;return this.watchScroll&&o.removeEventListener("scroll",this.watchScroll,!1),this};var r="",i=function(o,e,i){if(!e.value)throw Error("please set required parameters");if(r=e.value.name,!i.context)throw Error("it is not a vnode");if(i.context.$root){var l,n=i.context.$root,s=e.value,c=s.name,a=s.type;void 0===a&&(a="");var d=s.storageMode;void 0===d&&(d="");var u=s.domType;if(void 0===u&&(u=""),!c)throw Error("please set name");return"localstorage"===e.value.storageMode?l={dom:o,name:c,type:a,storageMode:d,vnode:i}:(n.$rescroll||(n.$rescroll={}),l={dom:o,name:c,type:a,storageMode:d,vnode:i,rescroll:n.$rescroll}),o.restoreScroll||(o.restoreScroll={}),o.restoreScroll[r]?void(u&&"tab"===u&&o.restoreScroll[r].update(l)):void(o.restoreScroll[r]=new t(l))}},l={inserted:function(o,e,t){return i(o,e,t)},componentUpdated:function(o,e,t){return i(o,e,t)},unbind:function(o){o.restoreScroll&&o.restoreScroll[r]&&(o.restoreScroll[r].destroy(),delete o.restoreScroll)}},n={install:function(o){o.directive("rescroll",l)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(n),o.default=n,o.directive=l,Object.defineProperty(o,"__esModule",{value:!0})});
